doctype html
html
  head
    meta(charset='UTF-8')
    meta(name='viewport' content='width=device-width, initial-scale=1.0')
    title Sales Entry - MWF
    link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet')
    link(rel='stylesheet' href='/css/style.css')
  body
    // Navbar
    nav.navbar.navbar-expand-lg.navbar-dark.bg-dark.py-2
      .container-fluid
        a.navbar-brand(href='/dashboard') MWF
        button.navbar-toggler(type='button' data-bs-toggle='collapse' data-bs-target='#navbarNav')
          span.navbar-toggler-icon
        #navbarNav.collapse.navbar-collapse
          ul.navbar-nav
            li.nav-item
              a.nav-link(href='/dashboard') Dashboard
            li.nav-item
              a.nav-link(href='/sales') Sales
            li.nav-item
              a.nav-link(href='/saleslist') Saleslist
            li.nav-item
              a.nav-link(href='/salesRecords') SalesRecords
            li.nav-item
              a.nav-link.text-danger(href='/logout') Logout

    // Main Container
    .container.mt-5
      .row.justify-content-center
        .col-md-8.col-lg-7
          .card.shadow-lg.p-4(style="background-color:#DEB887; border-radius:10px;")
            h2.text-center.mb-4 Record a Sale
            hr
            form#addSaleForm(action='/sales' method='post')
              .row.mb-3
                .col-md-6
                  label.form-label Customer Name
                  input.form-control(type='text' required name='customerName')
                .col-md-6
                  label.form-label Date
                  input.form-control(type='date' required name='date')
              .row.mb-3
                .col-md-6
                  label.form-label Product Type
                  select.form-select(name='productType' required)
                    option(value='') Select Type
                    option(value='wood') Wood
                    option(value='furniture') Furniture
                .col-md-6
                  label.form-label Product Name
                  select.form-select(name='productName' required)
                    option(value='') Choose...
                    option(value='timber') Timber
                    option(value='poles') Poles
                    option(value='hard-wood') Hard-wood
                    option(value='soft-wood') Soft-wood
                    option(value='bed') Bed
                    option(value='sofa') Sofa
                    option(value='dining-table') Dining Table
                    option(value='cupboards') Cupboards
                    option(value='drawers') Drawers
              .row.mb-3
                .col-md-6
                  label.form-label Quantity
                  input#quantity.form-control(type='number' min='1' required name='quantity')
                .col-md-6
                  label.form-label Include Transport (5%)
                  select#transport.form-select(name='transport' required)
                    option(value='') Choose
                    option(value='Yes') Yes
                    option(value='No') No
              .row.mb-3
                .col-md-6
                  label.form-label Payment Type
                  select.form-select(name='paymentType' required)
                    option(value='') Choose
                    option(value='cash') Cash
                    option(value='cheque') Cheque
                    option(value='bankOverdraft') Bank Overdraft
                .col-md-6
                  label.form-label Sales Agent
                  input.form-control(type='text' required name='salesAgent')
              
              // Selling Price and Total Amount side by side
              .row.mb-3
                .col-md-6
                  label.form-label Selling Price per Unit (UGX)
                  input#sellingPrice.form-control(type='number' min='1' required name='sellingPrice')
                .col-md-6
                  label.form-label Total Amount (UGX)
                  input#totalAmount.form-control(type='number' name='totalAmount' readonly style='background-color:#f8f9fa; font-weight:bold;')
              
              .d-grid
                button.btn.btn-dark(type='submit') Submit Sale

    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js')
    // Custom script for total calculation
    script.
      document.addEventListener('DOMContentLoaded', function () {
        const quantityInput = document.getElementById('quantity');
        const priceInput = document.getElementById('sellingPrice');
        const transportSelect = document.getElementById('transport');
        const totalInput = document.getElementById('totalAmount');

        function calculateTotal() {
          const qty = parseFloat(quantityInput.value) || 0;
          const price = parseFloat(priceInput.value) || 0;
          const baseTotal = qty * price;
          let finalTotal = baseTotal;

          if (transportSelect.value === 'Yes') {
            finalTotal = baseTotal * 1.05; // adds 5% transport cost
          }

          totalInput.value = finalTotal.toFixed(2);
        }

        quantityInput.addEventListener('input', calculateTotal);
        priceInput.addEventListener('input', calculateTotal);
        transportSelect.addEventListener('change', calculateTotal);
      });
script(src='/js/formValidation.js')