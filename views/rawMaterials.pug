doctype html
html
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title Raw Materials - MWF
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet")
    link(href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet")
    link(rel='stylesheet' href='/css/style.css')
    style.
      .summary-card p { font-size: 0.9rem; font-weight: 600; 
        background-color: burlywood;
        color: #4e342e;
        border-radius: 0.75rem;
        transition: transform 0.2s ease-in-out;
        background-size: contain;
      }
      .summary-card:hover { transform: translateY(-3px); }

  body
    // Navbar
    nav.navbar.navbar-expand-lg.navbar-dark.bg-dark
      .container-fluid
        a.navbar-brand(href="/dashboard") MWF Dashboard
        button.navbar-toggler(type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav")
          span.navbar-toggler-icon
        #navbarNav.collapse.navbar-collapse.justify-content-end
          ul.navbar-nav
            li.nav-item
              a.nav-link(href="/dashboard") Dashboard
            li.nav-item
              a.nav-link(href="/saleslist") Sales
            li.nav-item
              a.nav-link(href="/stocklist") Stock
            li.nav-item
              a.nav-link.text-danger(href="/logout") Log out

    // Content
    .container.my-5
      h2.mb-4 Raw Materials Overview

      // Overview Cards
      .row.g-3.mb-4
        .col-md-4
          .card.shadow-sm.text-center.summary-card.p-3
            h5 Total Materials
            p #{rawMaterials.totalQuantity} items
        .col-md-4
          .card.shadow-sm.text-center.summary-card.p-3
            h5 Suppliers
            p #{rawMaterials.suppliers} suppliers
        .col-md-4
          .card.shadow-sm.text-center.summary-card.p-3
            h5 Total Expense
            p #{rawMaterials.totalExpense} Shs

      // Table
      .card.shadow-sm.mb-5
        .card-body
          h5.mb-3 Raw Materials Inventory
          table.table.table-striped.table-hover
            thead.table-dark
              tr
                th Material
                th Quantity
                th Unit Cost
                th Supplier
            tbody
              each material in rawMaterials.items
                tr
                  td #{material.productName} 
                  td #{material.quantity}
                  td #{material.costPrice} Shs
                  td #{material.supplierName}

      // Charts
      .row.g-4
        .col-md-6
          .card.shadow-sm.p-3
            h6.text-center.mb-3 Material Quantities
            canvas#rawMaterialsBarChart
        .col-md-6
          .card.shadow-sm.p-3
            h6.text-center.mb-3 Usage Trend
            canvas#rawMaterialsLineChart

    // Scripts
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js")
    script(src="https://cdn.jsdelivr.net/npm/chart.js")
    script.
      const ctxBarRaw = document.getElementById('rawMaterialsBarChart');
      const ctxLineRaw = document.getElementById('rawMaterialsLineChart');
      new Chart(ctxBarRaw, {
        type: 'bar',
        data: {
          labels: !{JSON.stringify(rawMaterials.items.map(m => m.productName))},
          datasets: [{
            label: 'Quantity',
            data: !{JSON.stringify(rawMaterials.items.map(m => m.quantity))},
            backgroundColor: '#4e342e'
          }]
        }
      });
      new Chart(ctxLineRaw, {
        type: 'line',
        data: {
          labels: !{JSON.stringify(rawMaterials.trends.map(t => t.month))},
          datasets: [{
            label: 'Usage',
            data: !{JSON.stringify(rawMaterials.trends.map(t => t.usage))},
            borderColor: '#6f4e37',
            fill: false,
            tension: 0.3
          }]
        }
      });
